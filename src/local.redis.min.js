var LocalRedis=LocalRedis||{};LocalRedis.Utils=LocalRedis.Utils||{},function(e,t){"use strict";if(!e.localStorage)return;var n=e.localStorage.constructor.prototype,r=t.Expiration,i=t.Error;n._store=function(e,t){e=typeof e!="string"?JSON.stringify(e):e,t=typeof t!="string"?JSON.stringify(t):t;try{this.setItem(e,t)}catch(n){if(n===QUOTA_EXCEEDED_ERR)throw n}},n._retrieve=function(e){e=typeof e!="string"?JSON.stringify(e):e;var t=this.getItem(e);try{t=JSON.parse(t)}catch(n){}finally{return t}},n._remove=function(e){e=typeof e!="string"?JSON.stringify(e):e,this.removeItem(e)},n._exists=function(e){var t=!0,n,r;if(e instanceof Array)for(n=0,r=e.length;n<r;n++)this.hasOwnProperty(e[n])||(t=!1);else t=!!this.hasOwnProperty(e);return t},n.del=function(e){var t=0,n,i;e=e instanceof Array?e:arguments;for(n=0,i=e.length;n<i;n++)this._exists(e[n])&&(r.removeExpirationOf(e[n],this),this._remove(e[n]),++t);return t},n.exists=function(e){if(arguments.length>1)throw new i.generateError(0);return this._exists(e)?1:0},n.rename=function(e,t){var n="rename";if(arguments.length!==2)throw new i.generateError(0,n);if(e===t)throw new i.generateError(6,n);if(!this._exists(e))throw new i.generateError(7,n);r.hasExpiration(t,this)&&r.removeExpirationOf(t,this);var s=this._retrieve(e);this._store(t,s);if(r.hasExpiration(e,this)){var o=r.getExpirationTTL(e,this);this.pexpire(t,o),r.removeExpirationOf(e,this)}this._remove(e)},n.renamenx=function(e,t){if(arguments.length!==2)throw new i.generateError(0);if(e===t)throw new i.generateError(6);if(!this._exists(e))throw new i.generateError(7);if(this._exists(t))return 0;var n=this._retrieve(e);return this._store(t,n),this._remove(e),1},n.getkey=function(e){if(arguments.length>2)throw new i.generateError(0);var t,n,r,s,o=[],u;u=!!arguments[1];for(t=0,n=this.length;t<n;t++){r=this.key(t),s=this.getItem(r);if(e===s){o.push(r);if(!u)break}}return o.length===1?o=o[0]:o.length||(o=null),o},n.expire=function(e,t){if(arguments.length!==2)throw new i.generateError(0);var n=r.createExpirationKey(e),s=this,o;t=parseFloat(t,10);if(!t)throw new i.generateError(5);return this._exists(e)?(t*=1e3,o=setTimeout(function(){s._remove(e),s._remove(n)},t),o?(r.hasExpiration(e,this)&&r.removeExpirationOf(e,this),r.setExpirationOf(e,o,t,(new Date).getTime(),this),1):0):0},n.pexpire=function(e,t){if(arguments.length!==2)throw i.generateError(0);t=parseFloat(t,10);if(!t)throw i.generateError(5);return this.expire(e,t/1e3)},n.expireat=function(e,t){if(arguments.length!==2)throw i.generateError(0);var n=(new Date).getTime()/1e3,r=t-n;if(r<0)throw i.generateError(4);return this.expire(e,r)},n.pexpireat=function(e,t){if(arguments.length!==2)throw i.generateError(0);var n=t-(new Date).getTime();if(n<0)throw i.generateError(4);return this.pexpire(e,n)},n.persist=function(e){if(arguments.length!==1)throw i.generateError(0);return!this._exists(e)||!r.hasExpiration(e,this)?0:(clearTimeout(r.getExpirationID(e,this)),this._remove(r.createExpirationKey(e)),1)},n.ttl=function(e){if(arguments.length!==1)throw i.generateError(0);return!this._exists(e)||!r.hasExpiration(e,this)?-1:r.getExpirationTTL(e,this)/1e3},n.pttl=function(e){if(arguments.length!==1)throw i.generateError(0);return this.ttl(e)*1e3},n.randomkey=function(){var e=Object.keys(this),t=this.length,n=Math.floor(Math.random()*t);return t?e[n]:null},n.keys=function(e){var t=new RegExp(e),n,r,i=[],s=Object.keys(this);for(n=0,r=s.length;n<r;n++)t.test(s[n])&&i.push(s[n]);return i},n.get=function(e){return this._retrieve(e)},n.set=function(e,t){var n=r.hasExpiration(e,this),i;try{this._store(e,t),n&&(i=r.getExpirationDelay(e,this),this.persist(e))}catch(s){throw s}return this},n.getset=function(e,t){if(arguments.length!==2)throw i.generateError(0);var n=this._retrieve(e);if(typeof n!="string"&&n!==null)throw i.generateError(1);return this.set(e,t),n},n.mget=function(e){var t=[],n,r;e=e instanceof Array?e:arguments;for(n=0,r=e.length;n<r;n++)t[t.length]=this._retrieve(e[n]);return t},n.mset=function(e){var t=e instanceof Array,n=e instanceof Object,r,i,s;if(n&&!t){s=Object.keys(e);for(r=0,i=s.length;r<i;r++)this._store(s[r],e[s[r]])}else{e=t?e:arguments;for(r=0,i=e.length;r<i;r+=2)this._store(e[r],e[r+1])}return this},n.setnx=function(e,t){if(arguments.length!==2)throw i.generateError(0);return this._exists(e)?0:(this._store(e,t),1)},n.msetnx=function(e){var t=e instanceof Array,n=e instanceof Object,r,i,s=[];if(n&&!t)s=Object.keys(e);else{e=t?e:arguments;for(r=0,i=e.length;r<i;r+=2)s.push(e[r])}for(r=0,i=s.length;r<i;r++)if(this._exists(s[r]))return 0;for(r=0,i=e.length;r<i;r+=2)this._store(e[r],e[r+1]);return 1},n.incr=function(e){if(arguments.length!==1)throw i.generateError(0);var t=this._retrieve(e),n=typeof e,r=typeof t,s=parseInt(t,10),o=isNaN(s),u=r==="number",a=r==="string"&&!o,f=r==="string"&&o,l=!1;!o&&t>=Number.MAX_VALUE&&(l=!0);if(!u&&f||l||o&&this.hasOwnProperty(e))throw i.generateError(2);u||a?t=s+1:t=1,this._store(e,t)},n.incrby=function(e,t){if(arguments.length!==2)throw i.generateError(0);var n=this._retrieve(e),r=typeof n,s=typeof t,o=parseInt(n,10),u=parseInt(t,10),a=isNaN(u),f=isNaN(o),l=r==="number",c=s==="number",h=r==="string"&&!f,p=r==="string"&&f,d=s==="string"&&!a,v=s==="string"&&a,m=!1;if(!f&&n>=Number.MAX_VALUE||!a&&t>=Number.MAX_VALUE)m=!0;if(!l&&p||f&&this.hasOwnProperty(e)||a||!c&&v||m)throw i.generateError(2);if((l||h)&&(c||d))n=o+u;else if(c||d)n=u;this._store(e,n)},n.mincr=function(e){var t,n;e=e instanceof Array?e:arguments;for(t=0,n=e.length;t<n;t++)this.incr(e[t])},n.mincrby=function(e){var t,n,r;if(e instanceof Array||typeof e=="string"){e=e instanceof Array?e:arguments;if((e.length&1)!==0)throw i.generateError(0);for(t=0,n=e.length;t<n;t+=2)this.incrby(e[t],e[t+1])}else if(e instanceof Object)for(r in e)this.incrby(r,e[r])},n.append=function(e,t){var n=this._exists(e)?this._retrieve(e):"",r=typeof n=="string";return r&&(n+=t,this._store(e,n)),r?n.length:1},n.strlen=function(e){var t=this._retrieve(e);if(!t)return 0;if(typeof t=="string")return t.length;throw i.generateError(1)},n.setex=function(e,t,n){if(arguments.length!==3)throw i.generateError(0);this._store(e,t),this.expire(e,n)},n.psetex=function(e,t,n){if(arguments.length!==3)throw i.generateError(0);this._store(e,t),this.pexpire(e,n)}}(window,LocalRedis.Utils);